server {
    listen   <%= @repo_port %>;

    server_name localhost;

    access_log /var/log/nginx/access_repo.log;
    error_log /var/log/nginx/error_repo.log debug;

    charset utf-8;
    client_max_body_size 2M;
    autoindex off;

    if ( $request_method !~ ^(GET|HEAD)$ ) {
        return 444;
    }

    location / {
        root <%= @repo_root %>;
        error_page 403 =200 /index.html;
        location /index.html { internal; }
    }

    location ~ /\.ht {
        deny  all;
    }

    location  /dump/ {
        deny  all;
    }

}
