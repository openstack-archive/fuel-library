#
# This file autogenerated by Puppet
# Do not edit, changes will be overwritten
#


<% if @use_ssl =~ /^(default|exist|custom)$/ -%>
# SSL support
<% if @osfamily == 'RedHat' -%>
LoadModule ssl_module modules/mod_ssl.so
<% end -%>

SSLPassPhraseDialog  builtin
SSLSessionCache         shmcb:/var/cache/mod_ssl/scache(512000)
SSLSessionCacheTimeout  300
SSLMutex default
SSLRandomSeed startup file:/dev/urandom  256
SSLRandomSeed connect builtin
SSLCryptoDevice builtin
<% end -%>

<% if @use_syslog -%>
ErrorLog syslog:local1
<% end -%>

<VirtualHost *:<%= @http_port %>>
  <Location /websockify>
    ProxyPass ws://<%= @novnc_address %>:6080/websockify
    ProxyPassReverse ws://<%= @novnc_address %>:6080/websockify
  </Location>
  <LocationMatch ^/(vnc_auto.html|include)>
    ProxyPassMatch http://<%= @novnc_address %>:6080
    ProxyPassReverse http://<%= @novnc_address %>:6080
  </LocationMatch>
  RedirectMatch permanent ^/$ <%= @root_url %>/
<% if @use_ssl =~ /^(default|exist|custom)$/ -%>
  RewriteEngine On
  RewriteCond %{HTTPS} off
  RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R]
</VirtualHost>

<VirtualHost *:<%= @https_port %>>
  <Location /websockify>
    ProxyPass ws://<%= @novnc_address %>:6080/websockify
    ProxyPassReverse ws://<%= @novnc_address %>:6080/websockify
  </Location>
  <LocationMatch ^/(vnc_auto.html|include)>
    ProxyPassMatch http://<%= @novnc_address %>:6080
    ProxyPassReverse http://<%= @novnc_address %>:6080
  </LocationMatch>
  RedirectMatch permanent ^/$ <%= @root_url %>/
  SSLEngine on
  SSLCertificateFile <%= @ssl_cert_file %>
  SSLCertificateKeyFile <%= @ssl_key_file %>
<% end -%>
</VirtualHost>
